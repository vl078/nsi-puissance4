import numpy as np

# Constantes du jeu
LIGNES = 6
COLONNES = 7
VIDE = 0
JOUEUR_1 = 1  # Joueur 1
JOUEUR_2 = 2  # Joueur 2

# Création de la grille
def creer_grille():
    return np.zeros((LIGNES, COLONNES), int)

# Affichage de la grille
def afficher_grille(grille):
    print("\n")
    for ligne in grille:
        print(" | ".join(str(x) for x in ligne))
        print("-" * 29)

# Vérifier si un emplacement est valide
def est_valide(grille, col):
    return grille[LIGNES-1][col] == VIDE

# Obtenir la ligne disponible dans une colonne
def obtenir_ligne(grille, col):
    for r in range(LIGNES):
        if grille[r][col] == VIDE:
            return r
    return -1

# Vérifier si un joueur a gagné
def verifie_gagnant(grille, joueur):
    # Vérification horizontale
    for r in range(LIGNES):
        for c in range(COLONNES-3):
            if all(grille[r][c+i] == joueur for i in range(4)):
                return True

    # Vérification verticale
    for c in range(COLONNES):
        for r in range(LIGNES-3):
            if all(grille[r+i][c] == joueur for i in range(4)):
                return True

    # Vérification diagonale (descendante)
    for r in range(LIGNES-3):
        for c in range(COLONNES-3):
            if all(grille[r+i][c+i] == joueur for i in range(4)):
                return True

    # Vérification diagonale (montante)
    for r in range(3, LIGNES):
        for c in range(COLONNES-3):
            if all(grille[r-i][c+i] == joueur for i in range(4)):
                return True

    return False

# Fonction principale du jeu
def puissance4():
    grille = creer_grille()
    tour = 0  # Tour du joueur, 0 pour Joueur 1, 1 pour Joueur 2
    joueur = JOUEUR_1  # Joueur 1 commence
    while True:
        afficher_grille(grille)
        try:
            # Demander à l'utilisateur de choisir une colonne
            col = int(input(f"Joueur {joueur} (1 ou 2), choisissez une colonne (0 à 6) : "))
            if col < 0 or col >= COLONNES or not est_valide(grille, col):
                print("Colonne invalide ou pleine. Essayez encore.")
                continue
        except ValueError:
            print("Veuillez entrer un numéro de colonne valide.")
            continue
        
        # Placer le pion
        ligne = obtenir_ligne(grille, col)
        grille[ligne][col] = joueur

        # Vérification du gagnant
        if verifie_gagnant(grille, joueur):
            afficher_grille(grille)
            print(f"Le joueur {joueur} a gagné !")
            break

        # Vérification match nul (grille pleine)
        if np.all(grille != VIDE):
            afficher_grille(grille)
            print("Match nul !")
            break

        # Changer de joueur
        joueur = JOUEUR_2 if joueur == JOUEUR_1 else JOUEUR_1

# Lancer le jeu
if __name__ == "__main__":
    puissance4()
